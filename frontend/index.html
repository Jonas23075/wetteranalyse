<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Wetteranalyse Dashboard</title>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <!-- Plotly -->
    <script src="https://cdn.plot.ly/plotly-2.32.0.min.js"></script>

    <!-- Custom Style -->
    <link rel="stylesheet" href="/static/style.css?v=1" />
</head>
<body>

<div class="layout">

    <!-- Sidebar -->
    <aside class="sidebar">

        <!-- Search -->
        <div class="card">
            <h2 class="card-title">Station suchen</h2>

            <div class="search-group">
                <input id="address-input" type="text" placeholder="Name oder ID..." class="input" />
                <button id="address-go" class="btn">Suchen</button>
            </div>

            <div id="autocomplete-list" class="autocomplete hidden"></div>
        </div>

        <!-- Live Wetter -->
        <div class="card">
            <h2 class="card-title">Live Wetter</h2>

            <p id="station-name" class="live-title">Keine Station</p>

            <div class="live-row"><span>Temperatur:</span><strong id="temp">-- °C</strong></div>
            <div class="live-row"><span>Wind:</span><strong id="wind">-- km/h</strong></div>
            <div class="live-row"><span>Feuchtigkeit:</span><strong id="humidity">-- %</strong></div>

            <p id="date" class="timestamp">--</p>
        </div>

        <!-- Nearby Stations -->
        <div class="card">
            <h2 class="card-title">Nächste Stationen</h2>
            <ul id="nearest-list" class="nearest-list"></ul>
        </div>

    </aside>

    <!-- Main -->
    <main class="main">

        <!-- Map -->
        <div class="card map-card">
            <div class="map-header">
                <h2 class="card-title">Karte</h2>

                <label class="toggle">
                    <input type="checkbox" id="stationCheckbox" />
                    <span>Stationen anzeigen</span>
                </label>
            </div>

            <div id="map" class="map"></div>
        </div>

        <!-- Chart Controls -->
        <div class="card">
            <h2 class="card-title">Analysebereich</h2>

            <div id="available-dates-info" class="dates-row">
                Verfügbarer Zeitraum:
                <strong id="min-date-display">--</strong>
                bis
                <strong id="max-date-display">--</strong>
            </div>

            <div class="controls-grid">

                <div>
                    <label>Startdatum</label>
                    <input type="date" id="chart-start-date" class="input" />
                </div>

                <div>
                    <label>Enddatum</label>
                    <input type="date" id="chart-end-date" class="input" />
                </div>

                <div>
                    <label>Metrik</label>
                    <select id="chart-metric" class="input">
                        <option value="TMK">Durchschnittstemperatur</option>
                        <option value="TXK">Max Temperatur</option>
                        <option value="TNK">Min Temperatur</option>
                        <option value="RSK">Niederschlagssumme</option>
                        <option value="UPM">Luftfeuchtigkeit</option>
                    </select>
                </div>

                <div>
                    <label>Aggregation</label>
                    <select id="chart-aggregation" class="input">
                        <option value="daily">Täglich</option>
                        <option value="monthly">Monatlich</option>
                        <option value="yearly">Jährlich</option>
                    </select>
                </div>

            </div>

            <div class="flex-end">
                <button id="run-analysis" class="btn-primary">Analyse starten</button>
            </div>
        </div>

        <!-- Chart -->
        <div class="card">
            <h2 class="card-title">Diagramm</h2>
            <div id="chart" class="chart"></div>
        </div>

        <!-- Table -->
        <div class="card">
            <h2 class="card-title">Historische Daten</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>Zeitraum</th>
                        <th>Durchschnitt</th>
                        <th>Max</th>
                        <th>Min</th>
                        <th>Niederschlag</th>
                        <th>Feuchte</th>
                    </tr>
                </thead>
                <tbody id="historical-table"></tbody>
            </table>
        </div>

    </main>

</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="/scripts/app.js"></script>
<script src="/scripts/map.js"></script>
<script src="/scripts/search.js"></script>
<script src="/scripts/analyse.js"></script>

</body>
</html>